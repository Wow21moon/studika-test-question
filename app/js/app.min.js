const dropdown=document.getElementById("dropdown_city"),choice_city=document.getElementById("choice_city"),city_list=document.getElementById("city-list"),select_city_block=document.getElementById("select-city-block"),search_city_input=document.getElementById("search-city-input");let nameCityArg=[],cityData=[];function init(){headerSwiperMenu(),requestListCity()}function headerSwiperMenu(){const t=new Swiper(".swiper",{navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},slidesPerView:9,spaceBetween:30,freeMode:{enabled:!0,sticky:!0}});t.on("click",(function(){for(let e=0;e<t.slides.length;e++)t.slides[e].classList.remove("active-el"),t.slides[e].addEventListener("click",(function(){this.classList.add("active-el")}))}))}function requestListCity(){choice_city.addEventListener("click",(async function(){if(0==cityData.length){const t=await fetch("https://studika.ru/api/areas",{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"}}).then((t=>200!==t.status?Promise.reject():t.json())).catch((t=>console.log("ошибка"+t)));cityData=t,console.log("response",cityData)}updateCityList(),dropdown.classList.toggle("header__top__city__dropdown--active")}))}function updateCityList(){cityData.map((t=>{let e=document.createElement("div");e.classList.add("header__top__city__dropdown__list__item"),e.setAttribute("data-id",t.id),e.innerHTML=t.name,nameCityArg.push(t.name),city_list.append(e),null!=t.cities&&t.cities.reverse().map((i=>{let n=document.createElement("div");n.classList.add("header__top__city__dropdown__list__item"),n.setAttribute("data-id",i.id),nameCityArg.push(i.name),n.innerHTML+=`<span>${i.name}</span><span class="header__top__city__dropdown__list__item__state">${t.name}</span>`,e.after(n)}))}));selectCity(document.querySelectorAll("#city-list .header__top__city__dropdown__list__item")),searchCity(nameCityArg)}function selectCity(t){for(let e=0;e<t.length;e++)t[e].addEventListener("click",(function(){let t=document.createElement("div");t.classList.add("header__top__city__dropdown__select__item");let e=document.querySelectorAll(".header__top__city__dropdown__select__item");for(let t=0;t<e.length;t++)if(e[t].getAttribute("select-id")==this.getAttribute("data-id"))return void e[t].remove();0==this.children.length?(t.setAttribute("select-id",this.getAttribute("data-id")),t.innerHTML=`${this.textContent}<i class="fa-solid fa-xmark header__top__city__dropdown__select__item__cross"></i>`):(t.setAttribute("select-id",this.getAttribute("data-id")),t.innerHTML=`${this.children[0].textContent}<i class="fa-solid fa-xmark header__top__city__dropdown__select__item__cross"></i>`),select_city_block.append(t);let i=document.querySelectorAll(".header__top__city__dropdown__select__item .header__top__city__dropdown__select__item__cross");i.length>0&&deleteSelect(i)}))}function deleteSelect(t){for(let e=0;e<t.length;e++)t[e].addEventListener("click",(function(){this.parentElement.remove()}))}function searchCity(t){search_city_input.addEventListener("input",(function(){if(search_city_input.value.length>0)for(let e=0;e<t.length;e++){let i=t[e].split("")((function(e){for(let n=0;n<i.length;n++)1==search_city_input.value.length&&search_city_input.value==i[n]&&console.log("совпадение",i[n],t[e])}))(e)}}))}init();